(()=>{"use strict";var e={n:t=>{var s=t&&t.__esModule?()=>t.default:()=>t;return e.d(s,{a:s}),s},d:(t,s)=>{for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.React,s=window.wp.domReady;var i=e.n(s);const r=window.wp.element,l=window.wp.components,c=window.wp.i18n,n=window.wp.apiFetch;var a=e.n(n);const u=window.wp.url,o=new Map,p=()=>`${window.location.origin}${window.location.pathname}?page=tec-tickets-plus-admin-purchase-rules`,d=()=>window?.tec?.ticketsPlus?.commerce?.purchaseRules?.data,m=()=>d()?.ruleDescriptions,_=()=>{const e=d()?.rule||{id:0,config:{requirement:"quantity",ticketMinimum:1,ticketLimit:1,limitedTicket:""},scope:{connector:"all",criteria:[{term:"category",value:""}]}},{id:t,...s}=e;return s},h=()=>d()?.rule?.id||0,f=()=>d()?.currencySymbol,k=()=>d()?.currencySymbolPosition||"prefix",v=e=>{const t=f(),s=k(),i=e.toString();return"prefix"===s?`${t||""}${i}`:`${i}${t||""}`},x=async(e,t)=>{const s={search:t,per_page:20,page:1,hide_empty:!1};return await a()({path:(0,u.addQueryArgs)(`/wp/v2/${e}/`,s),method:"GET"})},g=async(e,t)=>{const s={search:t,per_page:20,page:1};return await a()({path:(0,u.addQueryArgs)(`/tec/v1/${e}/`,s),method:"GET"})},j=window.ReactJSXRuntime,b=({value:e,suffix:s,label:i,hideLabelFromVision:r,allowsFloat:c,...n})=>{const a=10+8*(e=(e=isNaN(e)?"":e).toString()).toString().length,u=e&&e.length>0&&"0"!==e?"inline-block":"none",o="inspector-text-control-"+t.useId();return(0,j.jsxs)(t.Fragment,{children:[i&&!r&&(0,j.jsx)("label",{htmlFor:o,className:"tec-tickets-plus-purchase-rules-edit-form__label",children:i}),(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input tec-tickets-plus-purchase-rules-edit-form__input--with-suffix",children:(0,j.jsxs)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__input--with-suffix__inner-container",children:[(0,j.jsx)(l.TextControl,{...n,label:r?i:"",hideLabelFromVision:r,type:"number",value:e,step:c?"0.01":"1",id:o}),(0,j.jsx)("span",{style:{left:`${a}px`,display:u},className:"tec-tickets-plus-purchase-rules-edit-form__input--with-suffix__suffix",children:s})]})})]})},w=({value:e,prefix:s,label:i,hideLabelFromVision:r,allowsFloat:c,...n})=>{const a=(e=(e=isNaN(e)?"":e).toString())&&e.length>0&&"0"!==e?"inline-block":"none",u="inspector-text-control-"+t.useId();return(0,j.jsxs)(t.Fragment,{children:[i&&!r&&(0,j.jsx)("label",{htmlFor:u,className:"tec-tickets-plus-purchase-rules-edit-form__label",children:i}),(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input tec-tickets-plus-purchase-rules-edit-form__input--with-prefix",children:(0,j.jsxs)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__input--with-prefix__inner-container",children:[(0,j.jsx)("span",{style:{display:a},className:"tec-tickets-plus-purchase-rules-edit-form__input--with-prefix__prefix",children:s}),(0,j.jsx)(l.TextControl,{...n,label:r?i:"",hideLabelFromVision:r,type:"number",value:e,step:c?"0.01":"1",id:u})]})})]})};const y=(0,r.createContext)(null),N=()=>{const e=(0,r.useContext)(y);if(null==e)throw new Error("Components must be wrapped in <EditForm />");return e},q=()=>{const{getValue:e,setValue:s}=N(),i=e("config")||{},r=i?.requirement||"quantity",n=i?.requirementValue||"",a=i?.discountType||"flat",u=i?.discountValue||"",o=[{label:(0,c.__)("Ticket quantity","event-tickets-plus"),value:"quantity"},{label:(0,c.__)("Order total","event-tickets-plus"),value:"total"}],p=[{label:(0,c.__)("Flat","event-tickets-plus"),value:"flat"},{label:(0,c.__)("Percentage","event-tickets-plus"),value:"percentage"}],d=e=>{s("config.requirement",r),s("config.requirementValue","quantity"===r?parseInt(e):parseFloat(e))},m=e=>{s("config.discountType",a),s("config.discountValue","percentage"===a?parseInt(e):parseFloat(e))},_=f(),h=k();return(0,j.jsxs)(t.Fragment,{children:[(0,j.jsxs)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control",children:[(0,j.jsxs)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-row",children:[(0,j.jsx)("span",{children:(0,c.__)("Purchase requirement","event-tickets-plus")}),(0,j.jsx)("span",{children:"quantity"===r?(0,c.__)("Quantity","event-tickets-plus"):(0,c.__)("Amount","event-tickets-plus")})]}),(0,j.jsxs)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-row",children:[(0,j.jsx)(l.SelectControl,{value:r,onChange:e=>{const t=e;s("config.requirement",t),s("config.requirementValue","quantity"===t?parseInt(n):parseFloat(n))},className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",label:(0,c.__)("Purchase requirement","event-tickets-plus"),hideLabelFromVision:!0,options:o,required:!0}),"quantity"===r?(0,j.jsx)(b,{value:n,onChange:d,className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",label:(0,c.__)("Value","event-tickets-plus"),hideLabelFromVision:!0,suffix:"+",allowsFloat:!1,required:!0,min:0}):"prefix"===h?(0,j.jsx)(w,{value:n,onChange:d,className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",label:(0,c.__)("Value","event-tickets-plus"),hideLabelFromVision:!0,prefix:_||"",allowsFloat:!0,required:!0,min:0}):(0,j.jsx)(b,{value:n,onChange:d,className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",label:(0,c.__)("Value","event-tickets-plus"),hideLabelFromVision:!0,suffix:_||"",allowsFloat:!0,required:!0,min:0})]})]}),(0,j.jsxs)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control",children:[(0,j.jsxs)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-row",children:[(0,j.jsx)("span",{children:(0,c.__)("Discount type","event-tickets-plus")}),(0,j.jsx)("span",{children:(0,c.__)("Amount","event-tickets-plus")})]}),(0,j.jsxs)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-row",children:[(0,j.jsx)(l.SelectControl,{value:a,onChange:e=>{const t=e;s("config.discountType",t),s("config.discountValue","percentage"===t?parseInt(u):parseFloat(u))},className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",label:(0,c.__)("Discount type","event-tickets-plus"),hideLabelFromVision:!0,options:p,required:!0}),"percentage"===a?(0,j.jsx)(b,{value:u,onChange:m,className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",label:(0,c.__)("Amount","event-tickets-plus"),hideLabelFromVision:!0,suffix:"%",required:!0,allowsFloat:!1,min:0}):"prefix"===h?(0,j.jsx)(w,{value:u,onChange:m,className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",label:(0,c.__)("Amount","event-tickets-plus"),hideLabelFromVision:!0,prefix:_||"",required:!0,allowsFloat:!0,min:0}):(0,j.jsx)(b,{value:u,onChange:m,className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",label:(0,c.__)("Amount","event-tickets-plus"),hideLabelFromVision:!0,suffix:_||"",required:!0,allowsFloat:!0,min:0})]}),u&&n?(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control tec-tickets-plus-purchase-rules-edit-form__description-container",children:(0,j.jsx)("p",{className:"tec-tickets-plus-purchase-rules-edit-form__rule_description",children:"total"===r?(0,c.sprintf)(/* translators: %1$s: discount amount, %2$s: minimum order total */ /* translators: %1$s: discount amount, %2$s: minimum order total */
(0,c.__)("Apply a %1$s discount to orders with a total of %2$s or more.","event-tickets-plus"),"percentage"===a?`${u}%`:v(u),v(n)):(0,c.sprintf)(/* translators: %1$s: discount amount, %2$d: minimum ticket quantity */ /* translators: %1$s: discount amount, %2$d: minimum ticket quantity */
(0,c.__)("Apply a %1$s discount to purchases of %2$d or more tickets.","event-tickets-plus"),"percentage"===a?`${u}%`:v(u),n)})}):null]})]})},C=window.wp.primitives,F=(0,j.jsx)(C.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,j.jsx)(C.Path,{d:"M11 12.5V17.5H12.5V12.5H17.5V11H12.5V6H11V11H6V12.5H11Z"})}),V=()=>{const{getValue:e,setValue:s}=N(),i=e("config")||{},r=i?.requirements||[{ticket:"",quantity:1}],n=i?.discountType||"flat",a=i?.discountValue||"",u=r.filter((e=>e.ticket&&e.quantity)).map((e=>`${e.quantity}+ ${e.ticket}`)),o=e=>{s("config.discountType",n),s("config.discountValue","percentage"===n?parseInt(e):parseFloat(e))},p=f(),d=k(),m=[{label:(0,c.__)("Flat","event-tickets-plus"),value:"flat"},{label:(0,c.__)("Percentage","event-tickets-plus"),value:"percentage"}];return(0,j.jsxs)(t.Fragment,{children:[(0,j.jsxs)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control",children:[(0,j.jsxs)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-row tec-tickets-plus-purchase-rules-edit-form__form-row--3-columns",children:[(0,j.jsxs)("span",{children:[(0,j.jsx)("span",{children:(0,c.__)("Discounted ticket(s)","event-tickets-plus")}),(0,j.jsx)(l.Tooltip,{text:(0,c.__)("Use a keyword to apply this rule to multiple tickets with the same or similar ticket names, e.g. Adult.","event-tickets-plus"),children:(0,j.jsx)("span",{className:"tec-tickets-plus-purchase-rules-edit-form__tooltip-anchor dashicons dashicons-info-outline"})})]}),(0,j.jsx)("span",{children:(0,c.__)("Quantity","event-tickets-plus")})]}),r.map(((e,t)=>(0,j.jsxs)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-row tec-tickets-plus-purchase-rules-edit-form__form-row--3-columns",children:[(0,j.jsx)(l.TextControl,{value:e.ticket,onChange:e=>((e,t)=>{const i=[...r];i[t].ticket=e,s("config.requirements",i)})(e,t),className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",label:(0,c.__)("Discounted ticket","event-tickets-plus"),placeholder:(0,c.__)("Ticket name keyword or ID","event-tickets-plus"),hideLabelFromVision:!0}),(0,j.jsx)(b,{value:e.quantity,onChange:e=>((e,t)=>{const i=[...r];i[t].quantity=parseInt(e),s("config.requirements",i)})(e,t),className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",label:(0,c.__)("Value","event-tickets-plus"),hideLabelFromVision:!0,suffix:"+",allowsFloat:!1,required:!0,min:1,step:"1"}),t>0&&(0,j.jsx)(l.Button,{icon:(0,j.jsx)("span",{className:"dashicons dashicons-trash"}),className:"tec-tickets-plus-purchase-rules-edit-form__inline-icon",onClick:()=>(e=>{const t=[...r];t.splice(e,1),s("config.requirements",t)})(t)})]},t))),(0,j.jsx)(l.Button,{variant:"link",className:"tec-tickets-plus-purchase-rules-edit-form__link",icon:F,iconPosition:"left",onClick:()=>s("config.requirements",[...r,{ticket:"",quantity:1}]),children:(0,c.__)("Add another ticket","event-tickets-plus")})]}),(0,j.jsxs)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control",children:[(0,j.jsxs)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-row tec-tickets-plus-purchase-rules-edit-form__form-row--3-columns",children:[(0,j.jsx)("span",{children:(0,c.__)("Discount type","event-tickets-plus")}),(0,j.jsx)("span",{children:(0,c.__)("Amount","event-tickets-plus")})]}),(0,j.jsxs)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-row tec-tickets-plus-purchase-rules-edit-form__form-row--3-columns",children:[(0,j.jsx)(l.SelectControl,{value:n,onChange:e=>{const t=e;s("config.discountType",t),s("config.discountValue","percentage"===t?parseInt(a):parseFloat(a))},className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",label:(0,c.__)("Discount type","event-tickets-plus"),hideLabelFromVision:!0,options:m,required:!0}),"percentage"===n?(0,j.jsx)(b,{value:a,onChange:o,className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",label:(0,c.__)("Amount","event-tickets-plus"),hideLabelFromVision:!0,suffix:"%",required:!0,allowsFloat:!1,min:0}):"prefix"===d?(0,j.jsx)(w,{value:a,onChange:o,className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",label:(0,c.__)("Amount","event-tickets-plus"),hideLabelFromVision:!0,prefix:p||"",required:!0,allowsFloat:!0,min:0}):(0,j.jsx)(b,{value:a,onChange:o,className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",label:(0,c.__)("Amount","event-tickets-plus"),hideLabelFromVision:!0,suffix:p||"",required:!0,allowsFloat:!0,min:0})]}),a&&u.length>0?(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control tec-tickets-plus-purchase-rules-edit-form__description-container",children:(0,j.jsx)("p",{className:"tec-tickets-plus-purchase-rules-edit-form__rule_description",children:(()=>{const e=(0,c.sprintf)(
// Translators: 1 is the discount value. 2 is the requirements.
// Translators: 1 is the discount value. 2 is the requirements.
(0,c.__)("Apply a %1$s ticket discount to purchases of %2$s tickets.","event-tickets-plus"),`${a}${"percentage"===n?"%":p}`,"%requirements%").split("%requirements%");return(0,j.jsxs)(t.Fragment,{children:[e[0],u.length>1?(0,j.jsxs)(t.Fragment,{children:[u.slice(0,-1).map(((e,s)=>(0,j.jsxs)(t.Fragment,{children:[s>0&&", ",(0,j.jsx)("i",{children:e})]},s))),` ${(0,c._x)("and","ticket discount","event-tickets-plus")} `,(0,j.jsx)("i",{children:u[u.length-1]})]}):(0,j.jsx)("i",{children:u[0]||""}),e[1]]})})()})}):null]})]})},T=({forTicket:e})=>{const{getValue:s,setValue:i}=N(),r=s("config"),n=r.ticketLimit,a=r.limitedTicket,u=()=>(0,j.jsxs)(t.Fragment,{children:[(0,c.__)("Limited ticket","event-tickets-plus"),(0,j.jsx)(l.Tooltip,{text:(0,c.__)("Use a keyword to apply this rule to multiple tickets with the same or similar ticket names, e.g. Adult.","event-tickets-plus"),children:(0,j.jsx)("span",{className:"tec-tickets-plus-purchase-rules-edit-form__tooltip-anchor dashicons dashicons-info-outline"})})]});return(0,j.jsxs)(t.Fragment,{children:[e&&(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control",children:(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-row tec-tickets-plus-purchase-rules-edit-form__form-row--3-and-2-fifths",children:(0,j.jsx)(l.TextControl,{value:a,onChange:e=>i("config.limitedTicket",e),className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",label:(0,j.jsx)(u,{}),placeholder:(0,c.__)("Ticket name keyword","event-tickets-plus"),required:!0})})}),(0,j.jsxs)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control",children:[(0,j.jsx)(l.TextControl,{value:n,className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",label:(0,c.__)("Ticket limit","event-tickets-plus"),onChange:e=>i("config.ticketLimit",e),type:"number",min:1,required:!0}),e&&n&&n>0&&a?(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control tec-tickets-plus-purchase-rules-edit-form__description-container",children:(0,j.jsx)("p",{className:"tec-tickets-plus-purchase-rules-edit-form__rule_description",children:(()=>{const e=(0,c.sprintf)(
// Translators: 1 is the ticket limit. 2 is the ticket name.
// Translators: 1 is the ticket limit. 2 is the ticket name.
(0,c.__)("Limit each purchase to %1$d %2$s tickets.","event-tickets-plus"),n,"%limitedTicket%").split("%limitedTicket%");return(0,j.jsxs)(t.Fragment,{children:[e[0],(0,j.jsx)("i",{children:a}),e[1]]})})()})}):null,!e&&n&&n>0?(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control tec-tickets-plus-purchase-rules-edit-form__description-container",children:(0,j.jsx)("p",{className:"tec-tickets-plus-purchase-rules-edit-form__rule_description",children:(0,c.sprintf)((0,c.__)("Limit each purchase to %d tickets per event.","event-tickets-plus"),n)})}):null]})]})},$=()=>{const{getValue:e,setValue:s}=N(),i=e("config")||{},r=i.ticketMinimum,n=i.requirement,a=[{label:(0,c.__)("Ticket quantity","event-tickets-plus"),value:"quantity"},{label:(0,c.__)("Amount","event-tickets-plus"),value:"total"}];return(0,j.jsxs)(t.Fragment,{children:[(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control",children:(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-row tec-tickets-plus-purchase-rules-edit-form__form-row--3-and-2-fifths",children:(0,j.jsx)(l.SelectControl,{value:n,onChange:e=>{const t=e;s("config.requirement",t),s("config.ticketMinimum","quantity"===t?parseInt(r.toString()):parseFloat(r.toString()))},className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",label:(0,c.__)("Requirement","event-tickets-plus"),options:a,required:!0})})}),(0,j.jsxs)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control",children:["quantity"===n&&(0,j.jsx)(l.TextControl,{value:r,className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",label:(0,c.__)("Minimum","event-tickets-plus"),onChange:e=>s("config.ticketMinimum",parseInt(e)),type:"number",min:1,step:1,required:!0}),"total"===n&&("prefix"===k()?(0,j.jsx)(w,{value:r,className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",label:(0,c.__)("Minimum","event-tickets-plus"),onChange:e=>s("config.ticketMinimum",parseFloat(e)),allowsFloat:!0,prefix:f()||"",min:0,step:"0.01",required:!0}):(0,j.jsx)(b,{value:r,className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",label:(0,c.__)("Minimum","event-tickets-plus"),onChange:e=>s("config.ticketMinimum",parseFloat(e)),allowsFloat:!0,suffix:f()||"",min:0,step:"0.01",required:!0})),r&&r>0?(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control tec-tickets-plus-purchase-rules-edit-form__description-container",children:(0,j.jsx)("p",{className:"tec-tickets-plus-purchase-rules-edit-form__rule_description",children:"total"===n?(0,c.sprintf)(/* translators: %s: minimum purchase amount */ /* translators: %s: minimum purchase amount */
(0,c.__)("Require a minimum purchase of %s.","event-tickets-plus"),v(r)):(0,c.sprintf)(/* translators: %d: minimum purchase quantity */ /* translators: %d: minimum purchase quantity */
(0,c.__)("Require a minimum purchase of %d tickets.","event-tickets-plus"),r)})}):null]})]})},L=()=>{const{getValue:e,setValue:s}=N(),i=e("config")||{},r=i?.ticketMinimum||1,n=i?.limitedTicket||"",a=()=>(0,j.jsxs)(t.Fragment,{children:[(0,c.__)("Ticket","event-tickets-plus"),(0,j.jsx)(l.Tooltip,{text:(0,c.__)("Use a keyword to apply this rule to multiple tickets with the same or similar ticket names, e.g. Adult.","event-tickets-plus"),children:(0,j.jsx)("span",{className:"tec-tickets-plus-purchase-rules-edit-form__tooltip-anchor dashicons dashicons-info-outline"})})]});return(0,j.jsxs)(t.Fragment,{children:[(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control",children:(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-row tec-tickets-plus-purchase-rules-edit-form__form-row--3-and-2-fifths",children:(0,j.jsx)(l.TextControl,{value:n,onChange:e=>{s("config.ticketMinimum",parseInt(r.toString())),s("config.limitedTicket",e)},className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",label:(0,j.jsx)(a,{}),placeholder:(0,c.__)("Ticket name keyword","event-tickets-plus"),required:!0})})}),(0,j.jsxs)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control",children:[(0,j.jsx)(l.TextControl,{value:r,className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",label:(0,c.__)("Minimum","event-tickets-plus"),onChange:e=>s("config.ticketMinimum",parseInt(e)),type:"number",min:1,step:1,required:!0}),r&&r>0&&n&&(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control tec-tickets-plus-purchase-rules-edit-form__description-container",children:(0,j.jsx)("p",{className:"tec-tickets-plus-purchase-rules-edit-form__rule_description",children:(()=>{const e=(0,c.sprintf)(
// Translators: 1 is the limited ticket name. 2 is the minimum number of tickets to be purchased.
// Translators: 1 is the limited ticket name. 2 is the minimum number of tickets to be purchased.
(0,c.__)("Require %1$s tickets to be purchased in groups of %2$d or more.","event-tickets-plus"),"%limit%",r).split("%limit%");return(0,j.jsxs)(j.Fragment,{children:[e[0],(0,j.jsx)("i",{children:n}),e[1]]})})()})})]})]})},S=window.wp.hooks,R=(()=>{const e=d()?.roles;if(!e)return;return Object.keys(e).map((t=>({label:e[t],value:t})))})(),A=(0,S.applyFilters)("tec_tickets_plus_purchase_rules_user_role_restriction_options",[...R,{label:(0,c.__)("Any logged-in user","event-tickets-plus"),value:"not-guest"}]),P=(0,S.applyFilters)("tec_tickets_plus_purchase_rules_user_role_restriction_description_labels",[...R,{label:(0,c.__)("logged-in users","event-tickets-plus"),value:"not-guest"}]),M=()=>{const{getValue:e,setValue:t}=N(),s=e("config")?.userRoles||[],i=s.map((e=>P.find((t=>t.value===e))?.label)),r=(0,c._x)("or","user role restriction","event-tickets-plus");return(0,j.jsxs)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control",children:[(0,j.jsx)("p",{className:"tec-tickets-plus-purchase-rules-edit-form__label tec-tickets-plus-purchase-rules-edit-form__label--my-5",children:(0,c.__)("Restrict ticket purchase to","event-tickets-plus")}),A.map((e=>(0,j.jsx)(l.CheckboxControl,{label:e.label,value:e.value,checked:s.includes(e.value),disabled:"not-guest"!==e.value&&s.includes("not-guest"),onChange:i=>((e,i)=>{if("not-guest"===i&&e)return void t("config.userRoles",["not-guest"]);const r=e?[...s,i]:s.filter((e=>e!==i)),l=[...new Set(r)];t("config.userRoles",l)})(i,e.value)},e.value))),s.length>0&&(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control tec-tickets-plus-purchase-rules-edit-form__description-container",children:(0,j.jsx)("p",{className:"tec-tickets-plus-purchase-rules-edit-form__rule_description",children:(0,c.sprintf)((0,c.__)("Limit ticket purchases to %s only.","event-tickets-plus"),i.join(` ${r} `))})})]})},E=()=>{const{getValue:e,setValue:s}=N(),i=e("config")||{},r=i?.restrictedTicket||"",n=i?.requiredTickets||[""],a=n.filter((e=>""!==e.trim())),u=()=>(0,j.jsxs)(t.Fragment,{children:[(0,c.__)("Restricted ticket","event-tickets-plus"),(0,j.jsx)(l.Tooltip,{text:(0,c.__)("Use a keyword to apply this rule to multiple tickets with the same or similar ticket names, e.g. Adult.","event-tickets-plus"),children:(0,j.jsx)("span",{className:"tec-tickets-plus-purchase-rules-edit-form__tooltip-anchor dashicons dashicons-info-outline"})})]});return(0,j.jsxs)(t.Fragment,{children:[(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control",children:(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-row tec-tickets-plus-purchase-rules-edit-form__form-row--3-and-2-fifths",children:(0,j.jsx)(l.TextControl,{value:r,onChange:e=>s("config.restrictedTicket",e),className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",label:(0,j.jsx)(u,{}),maxLength:191,placeholder:(0,c.__)("Ticket name keyword","event-tickets-plus"),required:!0})})}),(0,j.jsxs)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control",children:[n.length>0&&(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-row tec-tickets-plus-purchase-rules-edit-form__form-row--3-and-2-fifths",children:(0,j.jsxs)("span",{children:[(0,j.jsx)("span",{children:(0,c.__)("Required ticket","event-tickets-plus")}),(0,j.jsx)(l.Tooltip,{text:(0,c.__)("Use a keyword to apply this rule to multiple tickets with the same or similar ticket names, e.g. Adult.","event-tickets-plus"),children:(0,j.jsx)("span",{className:"tec-tickets-plus-purchase-rules-edit-form__tooltip-anchor dashicons dashicons-info-outline"})})]})}),n.map(((e,t)=>(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-row tec-tickets-plus-purchase-rules-edit-form__form-row--3-and-2-fifths",children:(0,j.jsx)(l.TextControl,{value:e,hideLabelFromVision:!0,onChange:e=>((e,t)=>{const i=[...n];i[t]=e,s("config.requiredTickets",i)})(e,t),className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",label:(0,c.__)("Required ticket","event-tickets-plus"),maxLength:191,placeholder:(0,c.__)("Ticket name keyword","event-tickets-plus"),required:!0})},t)))]}),(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control",children:r&&a.length>0&&(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control tec-tickets-plus-purchase-rules-edit-form__description-container",children:(0,j.jsx)("p",{className:"tec-tickets-plus-purchase-rules-edit-form__rule_description",children:(()=>{const e=(0,c.sprintf)(
// Translators: 1 is the restricted ticket name. 2 is the required ticket name.
// Translators: 1 is the restricted ticket name. 2 is the required ticket name.
(0,c.__)("Require any %1$s tickets to be bought with at least 1 %2$s ticket.","event-tickets-plus"),"%restricted%","%required%").split("%restricted%"),s=e[1].split("%required%");return(0,j.jsxs)(t.Fragment,{children:[e[0],(0,j.jsx)("i",{children:r}),s[0],a.length>1?(0,j.jsxs)(t.Fragment,{children:[a.slice(0,-1).map(((e,s)=>(0,j.jsxs)(t.Fragment,{children:[s>0&&", ",(0,j.jsx)("i",{children:e})]},s))),` ${(0,c._x)("or","combined purchase","event-tickets-plus")} `,(0,j.jsx)("i",{children:a[a.length-1]})]}):(0,j.jsx)("i",{children:a[0]}),s[1]]})})()})})})]})},I=()=>{const{type:e}=N();switch(e){case"order-discount":return(0,j.jsx)(q,{});case"ticket-discount":return(0,j.jsx)(V,{});case"event-purchase-limit":return(0,j.jsx)(T,{forTicket:!1});case"ticket-purchase-limit":return(0,j.jsx)(T,{forTicket:!0});case"event-purchase-min":return(0,j.jsx)($,{forTicket:!1});case"ticket-purchase-min":return(0,j.jsx)(L,{forTicket:!0});case"user-role-restriction":return(0,j.jsx)(M,{});case"combined-purchase":return(0,j.jsx)(E,{})}},B=()=>{var e;const{getValue:s,setValue:i}=N();return(0,j.jsxs)(t.Fragment,{children:[(0,j.jsx)("h4",{className:"tec-tickets-plus-purchase-rules-edit-form__heading",children:(0,c.__)("Rule Definition","event-tickets-plus")}),(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control",children:(0,j.jsx)(l.TextControl,{label:(0,c.__)("Rule name *","event-tickets-plus"),value:null!==(e=s("name"))&&void 0!==e?e:"",className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",onChange:e=>i("name",e),maxLength:191,required:!0})}),(0,j.jsx)(I,{})]})},D=window.wp.compose,O=void 0===window.tec.eventsPro?[{label:(0,c.__)("Event category","event-tickets-plus"),value:"category"},{label:(0,c.__)("Event title keyword","event-tickets-plus"),value:"title"},{label:(0,c.__)("Tag","event-tickets-plus"),value:"tag"},{label:(0,c.__)("Venue","event-tickets-plus"),value:"venue"}]:[{label:(0,c.__)("Event category","event-tickets-plus"),value:"category"},{label:(0,c.__)("Event title keyword","event-tickets-plus"),value:"title"},{label:(0,c.__)("Series","event-tickets-plus"),value:"series"},{label:(0,c.__)("Tag","event-tickets-plus"),value:"tag"},{label:(0,c.__)("Venue","event-tickets-plus"),value:"venue"}],H=(()=>{const e=d()?.termMap,t={category:new Map,series:new Map,tag:new Map,venue:new Map};if(!e)return t;for(const s in e)for(const i of e[s])t[s].set(i.value,i.label);return t})(),U=({index:e})=>{const{getValue:t,setValue:s}=N(),i=t("scope")?.criteria||[{term:"category",value:""}],n=(e,t)=>{const r=[...i];r[t]={...r[t],value:e},s("scope.criteria",r)};if("title"===i[e].term)return(0,j.jsx)(l.TextControl,{label:(0,c.__)("Criteria Option","event-tickets-plus"),value:i[e].value,onChange:t=>n(t,e),hideLabelFromVision:!0,placeholder:(0,c.__)("Event title keyword","event-tickets-plus"),required:!0});const[a,u]=(0,r.useState)(!1),p=[];H[i[e].term].forEach(((e,t)=>p.push({value:t,label:e})));const[d,m]=(0,r.useState)(p),_=(0,D.useDebounce)((async t=>{if(t.length<3)return;u(!0);const s=await(async(e,t)=>{const s={category:e=>(async e=>{const t=`category-${e=e||""}`;if(o.has(t)){const e=o.get(t);if(!Array.isArray(e))throw e;return e.map((e=>({label:e.name,value:e.id})))}try{const s=await x("tribe_events_cat",e);return o.set(t,s),s.map((e=>({label:e.name,value:e.id})))}catch(e){throw o.set(t,e),e}})(e),series:e=>(async e=>{if(void 0===typeof window?.tec?.eventsPro)return[];const t=`series-${e=e||""}`;if(o.has(t)){const e=o.get(t);if(!Array.isArray(e))throw e;return e.map((e=>({label:e.title.rendered,value:e.id})))}try{const s=await g("series",e);return o.set(t,s),s.map((e=>({label:e.title.rendered,value:e.id})))}catch(e){throw o.set(t,e),e}})(e),tag:e=>(async e=>{const t=`tag-${e=e||""}`;if(o.has(t)){const e=o.get(t);if(!Array.isArray(e))throw e;return e.map((e=>({label:e.name,value:e.id})))}try{const s=await x("tags",e);return o.set(t,s),s.map((e=>({label:e.name,value:e.id})))}catch(e){throw o.set(t,e),e}})(e),venue:e=>(async e=>{const t=`venues-${e=e||""}`;if(o.has(t)){const e=o.get(t);if(!Array.isArray(e))throw e;return e.map((e=>({label:e.title.rendered,value:e.id})))}try{const s=await g("venues",e);return o.set(t,s),s.map((e=>({label:e.title.rendered,value:e.id})))}catch(e){throw o.set(t,e),e}})(e)};if(!(e in s))throw new Error(`Invalid taxonomy: ${e}`);return await s[e](t)})(i[e].term,t);s.forEach((t=>{H[i[e].term].set(t.value,t.label)})),m(s),u(!1)}),500);return(0,j.jsx)(l.ComboboxControl,{label:(0,c.__)("Criteria Option","event-tickets-plus"),hideLabelFromVision:!0,value:i[e].value,onChange:t=>n(t||"",e),options:d,isLoading:a,onFilterValueChange:e=>_(e),placeholder:(0,c.__)("Type at least 3 characters to searchâ€¦","event-tickets-plus")})},Q=()=>{const{getValue:e}=N(),s=e("scope"),i=s?.connector||"all",r=(0,c.__)("This rule applies to all events.","event-tickets-plus"),l=(0,c.__)("This rule is never automatically applied, but can be manually added to any event.","event-tickets-plus");if("all"===i||"none"===i)return(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control tec-tickets-plus-purchase-rules-edit-form__description-container",children:(0,j.jsx)("p",{className:"tec-tickets-plus-purchase-rules-edit-form__rule_description",children:"all"===i?r:l})});const n=(s?.criteria||[]).filter((e=>e?.value));if(0===n.length)return(0,j.jsx)(t.Fragment,{});const a=n.filter((e=>"venue"===e.term&&e.value)).map((e=>H[e.term].get(e.value)||"")),u=n.filter((e=>"category"===e.term&&e.value)).map((e=>H[e.term].get(e.value)||"")),o=n.filter((e=>"title"===e.term&&e.value)).map((e=>e.value)),p=n.filter((e=>"tag"===e.term&&e.value)).map((e=>H[e.term].get(e.value)||"")),d=n.filter((e=>"series"===e.term&&e.value)).map((e=>H[e.term].get(e.value)||"")),m=(e,t)=>{if(0===t.length)return null;const s=[e+" "];return t.length>1?(t.slice(0,-1).forEach(((e,t)=>{t>0&&s.push(", "),s.push((0,j.jsx)("i",{children:e},`value-${t}`))})),t.length>2&&s.push(","),s.push(` ${i} `),s.push((0,j.jsx)("i",{children:t[t.length-1]},"value-"+(t.length-1)))):s.push((0,j.jsx)("i",{children:t[0]},"value-0")),s},_=[m((0,c._x)("at","scope","event-tickets-plus"),a),m((0,c._x)("with event title keyword","scope","event-tickets-plus"),o),m((0,c._x)("with tag","scope","event-tickets-plus"),p),m((0,c._x)("in Series","scope","event-tickets-plus"),d),m((0,c._x)("in event category","scope","event-tickets-plus"),u)].filter((e=>null!==e)),h=[];_.forEach(((e,t)=>{t>0&&(t<_.length-1?h.push(", "):(_.length>2&&h.push(","),h.push(` ${i} `)));const s=e;for(let e=0;e<s.length;e++)h.push(s[e])}));const f=(0,c.sprintf)(
// Translators: %1$s is a placeholder for the sentence of criteria.
// Translators: %1$s is a placeholder for the sentence of criteria.
(0,c.__)("This rule applies to events %1$s.","event-tickets-plus"),"%sentence%").split("%sentence%");return(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control tec-tickets-plus-purchase-rules-edit-form__description-container",children:(0,j.jsxs)("p",{className:"tec-tickets-plus-purchase-rules-edit-form__rule_description",children:[f[0],h,f[1]]})})},Y=()=>{const{getValue:e,setValue:s}=N(),i=e("scope"),r=i.connector,n=i.criteria;return(0,j.jsxs)(t.Fragment,{children:[(0,j.jsx)("h4",{className:"tec-tickets-plus-purchase-rules-edit-form__heading",children:(0,c.__)("Scope","event-tickets-plus")}),(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control tec-tickets-plus-purchase-rules-edit-form__form-control--scope",children:(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-row tec-tickets-plus-purchase-rules-edit-form__form-row--3-and-2-fifths",children:(0,j.jsx)(l.SelectControl,{label:(0,c.__)("Add rule to","event-tickets-plus"),value:r,onChange:e=>s("scope.connector",e),className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",options:[{label:(0,c.__)("All events","event-tickets-plus"),value:"all"},{label:(0,c.__)("Events matching ALL criteria","event-tickets-plus"),value:"and"},{label:(0,c.__)("Events matching ANY criteria","event-tickets-plus"),value:"or"},{label:(0,c.__)("None (rule can be applied manually only)","event-tickets-plus"),value:"none"}],required:!0})})}),"all"!==r&&"none"!==r?(0,j.jsx)(t.Fragment,{children:(0,j.jsxs)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control tec-tickets-plus-purchase-rules-edit-form__form-control--criteria",children:[(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-row tec-tickets-plus-purchase-rules-edit-form__form-row--3-columns",children:(0,j.jsx)("span",{children:(0,c.__)("Criteria","event-tickets-plus")})}),n.map(((e,t)=>e?.term?(0,j.jsxs)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-row tec-tickets-plus-purchase-rules-edit-form__form-row--3-columns-alt",children:[(0,j.jsx)(l.SelectControl,{value:e.term,onChange:e=>((e,t)=>{const i=[...n];i[t]={...i[t],term:e,value:""},s("scope.criteria",i)})(e,t),className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",label:(0,c.__)("Criteria","event-tickets-plus"),options:O,hideLabelFromVision:!0}),(0,j.jsx)(U,{index:t}),t>0&&(0,j.jsx)(l.Button,{icon:(0,j.jsx)("span",{className:"dashicons dashicons-trash"}),className:"tec-tickets-plus-purchase-rules-edit-form__inline-icon",onClick:()=>(e=>{const t=[...n];t[e]={},s("scope.criteria",t)})(t)})]},`${e.term}-${t}`):null)),(0,j.jsx)(l.Button,{variant:"link",className:"tec-tickets-plus-purchase-rules-edit-form__link",icon:F,iconPosition:"left",onClick:()=>s("scope.criteria",[...n,{term:"category",value:""}]),children:(0,c.__)("Add criteria","event-tickets-plus")})]})}):null,(0,j.jsx)(Q,{})]})},G=()=>{const{getValue:e,setValue:s,type:i}=N(),r=e("config")?.message||"",n="order-discount"===i||"ticket-discount"===i;return(0,j.jsxs)(t.Fragment,{children:[(0,j.jsx)("h4",{className:"tec-tickets-plus-purchase-rules-edit-form__heading",children:(0,c.__)("Messaging","event-tickets-plus")}),(0,j.jsxs)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control",children:[(0,j.jsx)(l.TextControl,{label:n?(0,c.__)("Promotional message","event-tickets-plus"):(0,c.__)("Requirement message *","event-tickets-plus"),value:r,onChange:e=>s("config.message",e),className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",placeholder:n?(0,c.__)("e.g. Buy 4 or more tickets and get $5 off your purchase!","event-tickets-plus"):(0,c.__)("e.g. You need to purchase at least 2 tickets.","event-tickets-plus"),required:!n}),(0,j.jsx)("p",{className:"tec-tickets-plus-purchase-rules-edit-form__field-description",children:n?(0,c.__)("This message will display above tickets on event pages.","event-tickets-plus"):(0,c.__)("This message shows on the event page when the requirement is enforced and purchase is blocked.","event-tickets-plus")})]})]})},J=()=>{const e=m(),{type:s}=N();return(0,j.jsxs)(t.Fragment,{children:[(0,j.jsx)("span",{className:"tec-tickets-plus-purchase-rules-edit-form__header_title",children:e&&e[s]}),"user-role-restriction"===s?(0,j.jsx)("p",{children:(0,c.__)("Only selected user roles will be able to purchase tickets.","event-tickets-plus")}):null,"combined-purchase"===s?(0,j.jsx)("p",{children:(0,c.__)("To purchase any number of the restricted ticket, the order must contain at least one of the required ticket.","event-tickets-plus")}):null]})},z=({type:e})=>{const t=function(e){const[t,s]=(0,r.useState)(!0),i={type:e,..._()},[l,n]=(0,r.useState)(null),[u,o]=(0,r.useState)(i);return{type:e,onSave:async()=>{s(!0);try{const t=await a()({url:(e=h(),e>0?`${d()?.endpoint}/${e}`:d()?.endpoint),method:h()>0?"PUT":"POST",data:{...u,scope:{...u.scope,criteria:u.scope?.criteria?.filter((e=>e.term&&e.value))||[]}}});t?.id&&t?.id>0&&(window.location.href=p())}catch(e){n(e?.error||(0,c.__)("An error occurred while saving the rule.","event-tickets-plus"))}var e},setValue:(e,t)=>{o((i=>{const r=((e,t,s)=>{const i=t.split("."),r=JSON.parse(JSON.stringify(e));let l=r;for(let e=0;e<i.length-1;e++){const t=i[e];l[t]&&"object"==typeof l[t]||(l[t]={}),l=l[t]}return l[i[i.length-1]]=s,r})(i||{},e,t);return s(!(e=>{const{type:t,config:s,name:i,scope:r}=e;if(!t||!i)return!1;if("order-discount"!==t&&"ticket-discount"!==t&&!s?.message)return!1;if(!r||!r?.connector)return!1;if("all"!==r.connector&&"none"!==r.connector){if(!(r?.criteria?.length>0))return!1;if(!r.criteria.filter((e=>e.term&&e.value)).length)return!1}const l=s,c=s,n=s,a=s,u=s,o=s;return!!(("order-discount"!==t||l?.requirement&&l?.requirementValue&&l.requirementValue>0&&l?.discountType&&l?.discountValue&&l.discountValue>0)&&("ticket-discount"!==t||c?.discountType&&c?.discountValue&&c.discountValue>0&&c?.requirements?.length>0&&c.requirements.some((e=>e.ticket&&e.quantity>0)))&&("event-purchase-limit"!==t||n?.ticketLimit)&&("ticket-purchase-limit"!==t||n?.ticketLimit&&n.ticketLimit>0&&n?.limitedTicket)&&("event-purchase-min"!==t||a?.ticketMinimum&&a?.requirement)&&("ticket-purchase-min"!==t||a?.ticketMinimum&&a?.limitedTicket)&&("user-role-restriction"!==t||u?.userRoles?.length>0&&u.userRoles.some((e=>""!==e)))&&("combined-purchase"!==t||o?.restrictedTicket&&o?.requiredTickets?.length>0&&o.requiredTickets.some((e=>""!==e.trim()))))})(r)),r}))},getValue:e=>u[e]||null,isDisabled:t,setIsDisabled:s,error:l,setError:n}}(e),[s,i]=(0,r.useState)(!1),n=()=>i(!1),{isDisabled:u,onSave:o,error:m,setError:f}=t;return(0,j.jsxs)(y.Provider,{value:t,children:[m?(0,j.jsx)(l.Notice,{onRemove:()=>f(null),className:"tec-tickets-plus-purchase-rules-edit-form__notice",status:"error",isDismissible:!0,children:m}):null,s&&(0,j.jsx)(l.Modal,{size:"medium",title:(0,c.__)("Are you sure you want to cancel? Your changes will not be saved.","event-tickets-plus"),onRequestClose:n,children:(0,j.jsxs)(l.__experimentalHStack,{alignment:"center",children:[(0,j.jsx)(l.Button,{variant:"tertiary",className:"tec-tickets-plus-purchase-rules-edit-form__action-button",onClick:n,children:(0,c.__)("Remain on this page","event-tickets-plus")}),(0,j.jsx)("a",{className:"tec-tickets-plus-purchase-rules-edit-form__action-button components-button is-destructive",href:p(),children:(0,c.__)("Yes, I am sure.","event-tickets-plus")})]})}),(0,j.jsxs)(l.CardHeader,{className:"tec-tickets-plus-purchase-rules-edit-form__header",children:[(0,j.jsx)("span",{className:"tec-tickets-plus-purchase-rules-edit-form__header_badge",children:(0,c.__)("Rule:","event-tickets-plus")}),(0,j.jsx)(J,{})]}),(0,j.jsx)(l.CardBody,{className:"tec-tickets-plus-purchase-rules-edit-form__body",children:(0,j.jsx)(B,{})}),(0,j.jsx)(l.CardBody,{className:"tec-tickets-plus-purchase-rules-edit-form__body",children:(0,j.jsx)(Y,{})}),(0,j.jsx)(l.CardBody,{className:"tec-tickets-plus-purchase-rules-edit-form__body",children:(0,j.jsx)(G,{})}),(0,j.jsxs)(l.CardFooter,{className:"tec-tickets-plus-purchase-rules-edit-form__actions-container",children:[(0,j.jsx)(l.Button,{className:"tec-tickets-plus-purchase-rules-edit-form__action-button tec-tickets-plus-purchase-rules-edit-form__action-button--cancel",onClick:()=>i(!0),children:(0,c.__)("Cancel","event-tickets-plus")}),(0,j.jsx)(l.Button,{className:"tec-tickets-plus-purchase-rules-edit-form__action-button tec-tickets-plus-purchase-rules-edit-form__action-button--primary",disabled:u,onClick:o,children:(0,c.__)("Save Rule","event-tickets-plus")})]})]})},X=["discount","limit","minimum"],Z=[{disabled:!0,label:(0,c.__)("Select rule","event-tickets-plus"),value:""},{label:(0,c.__)("Discount","event-tickets-plus"),value:"discount"},{label:(0,c.__)("Purchase Limit","event-tickets-plus"),value:"limit"},{label:(0,c.__)("Purchase Minimum","event-tickets-plus"),value:"minimum"},{label:(0,c.__)("User Role Restriction","event-tickets-plus"),value:"user-role-restriction"},{label:(0,c.__)("Combined Purchase","event-tickets-plus"),value:"combined-purchase"}],K={discount:[{label:(0,c.__)("Per order","event-tickets-plus"),value:"order-discount"},{label:(0,c.__)("Per ticket","event-tickets-plus"),value:"ticket-discount"}],limit:[{label:(0,c.__)("Per event","event-tickets-plus"),value:"event-purchase-limit"},{label:(0,c.__)("Per ticket","event-tickets-plus"),value:"ticket-purchase-limit"}],minimum:[{label:(0,c.__)("Per event","event-tickets-plus"),value:"event-purchase-min"},{label:(0,c.__)("Per ticket","event-tickets-plus"),value:"ticket-purchase-min"}]},W=p(),ee=({setType:e})=>{const s=m(),[i,n]=(0,r.useState)(""),[a,u]=(0,r.useState)(""),[o,p]=(0,r.useState)(""),d=X.includes(i);return(0,j.jsx)(t.Fragment,{children:(0,j.jsxs)(l.CardBody,{className:"tec-tickets-plus-purchase-rules-edit-form__body",children:[(0,j.jsx)("h4",{className:"tec-tickets-plus-purchase-rules-edit-form__heading",children:(0,c.__)("Rule Type","event-tickets-plus")}),(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control",children:(0,j.jsx)(l.SelectControl,{label:(0,c.__)("Rule type","event-tickets-plus"),hideLabelFromVision:!0,value:i,className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",onChange:e=>{if(X.includes(e))return n(e),u(K[e][0].value),void p(K[e][0].value);n(e),u(""),p(e)},options:Z,required:!0})}),i&&d&&(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control",children:(0,j.jsx)(l.SelectControl,{label:(0,c.__)("Rule specific type","event-tickets-plus"),hideLabelFromVision:!0,value:a,className:"tec-tickets-plus-purchase-rules-edit-form__form-control__input",onChange:e=>{u(e),p(e)},options:K[i],required:!0})}),o?(0,j.jsx)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control tec-tickets-plus-purchase-rules-edit-form__description-container",children:(0,j.jsx)("p",{className:"tec-tickets-plus-purchase-rules-edit-form__rule_description tec-tickets-plus-purchase-rules-edit-form__rule_description--left-aligned",children:s[o]})}):null,(0,j.jsxs)("div",{className:"tec-tickets-plus-purchase-rules-edit-form__form-control tec-tickets-plus-purchase-rules-edit-form__actions-container",children:[(0,j.jsx)("a",{className:"tec-tickets-plus-purchase-rules-edit-form__action-button tec-tickets-plus-purchase-rules-edit-form__action-button--cancel",href:W,children:(0,c.__)("Cancel","event-tickets-plus")}),(0,j.jsxs)(l.Button,{className:"tec-tickets-plus-purchase-rules-edit-form__action-button tec-tickets-plus-purchase-rules-edit-form__action-button--next",disabled:!o,onClick:()=>{o&&e(o)},children:[(0,c.__)("Next","event-tickets-plus"),(0,j.jsx)("span",{className:"dashicons dashicons-arrow-right-alt2"})]})]})]})})},te=()=>{const[e,t]=(0,r.useState)(_()?.type||"");return(0,j.jsx)(l.Card,{isRounded:!1,className:"tec-tickets-plus-purchase-rules-edit-form",children:e?(0,j.jsx)(z,{type:e}):(0,j.jsx)(ee,{setType:t})})},se=tec.common.tecApi;i()((()=>{(0,se.registerMiddlewares)();const e=document.getElementById("tec-tickets-plus-purchase-rules-edit")||null;null!==e&&(0,r.createRoot)(e).render((0,j.jsx)(te,{}))})),window.ticketsPlus=window.ticketsPlus||{},window.ticketsPlus.purchaseRules=window.ticketsPlus.purchaseRules||{},window.ticketsPlus.purchaseRules.admin=window.ticketsPlus.purchaseRules.admin||{},window.ticketsPlus.purchaseRules.admin.page={}})();